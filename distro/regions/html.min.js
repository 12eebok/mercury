/*!
The HTML region utilizes the full HTML5 ContentEditable featureset and adds some layers on top of that to normalize it
between browsers and to make it nicer to use.

Dependencies:
*/
(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Mercury.HtmlRegion=function(e){function n(){try{window.rangy.init()}catch(e){return this.notify(this.t("requires Rangy")),!1}n.__super__.constructor.apply(this,arguments)}return t(n,e),n.define("Mercury.HtmlRegion","html"),n.include(Mercury.Region.Modules.DropIndicator),n.include(Mercury.Region.Modules.HtmlSelection),n.include(Mercury.Region.Modules.SelectionValue),n.supported=document.designMode&&(!Mercury.support.msie||Mercury.support.msie>=10)&&window.rangy&&window.rangy.supported,n.prototype.skipHistoryOnInitialize=!0,n.prototype.events={keydown:"handleKeyEvent"},n.prototype.build=function(){return this.document=this.el.get(0).ownerDocument,this.makeEditable(),this.setEditPreferences()},n.prototype.makeEditable=function(){return this.el.get(0).contentEditable=!0},n.prototype.setEditPreferences=function(){try{return this.document.execCommand("styleWithCSS",!1,!1),this.document.execCommand("insertBROnReturn",!1,!0),this.document.execCommand("enableInlineTableEditing",!1,!1),this.document.execCommand("enableObjectResizing",!1,!1)}catch(e){}},n.prototype.handleKeyEvent=function(e){if(e.keyCode>=37&&e.keyCode<=40)return;if(e.metaKey&&e.keyCode===90)return;e.keyCode===13&&typeof this.onReturnKey=="function"&&this.onReturnKey(e);if(e.metaKey)switch(e.keyCode){case 66:return e.preventDefault(),this.handleAction("bold");case 73:return e.preventDefault(),this.handleAction("italic");case 85:return e.preventDefault(),this.handleAction("underline")}return this.pushHistory(e.keyCode)},n.prototype.actions={bold:function(){return this.toggleWrapSelectedWordsInClass("red")},italic:function(){return this.toggleWrapSelectedWordsInClass("highlight")},underline:function(){return this.toggleWrapSelectedWordsInClass("blue")}},n}(Mercury.Region)}).call(this);